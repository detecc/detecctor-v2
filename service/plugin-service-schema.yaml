asyncapi: 2.0.0
info:
  title: Plugin Service
  version: 0.1.0
  description: "Plugin service executes plugins and processes client responses."
servers:
  development:
    url: node1.emxq.stockup.site:1883
    protocol: mqtt
    description: Demo EMXQ broker
channels:
  plugin/execute:
    publish:
      message:
        $ref: '#/components/messages/command'
  plugin/response:
    subscribe:
      message:
        $ref: '#/components/messages/payload'
  plugin/metadata:
    publish:
      message:
        $ref: '#/components/messages/payload'
  plugin/metadata/response:
    subscribe:
      message:
        $ref: '#/components/messages/payload'
components:
  messages:
    payload:
      payload:
        type: object
        properties:
          Id:
            type: string
            description: ID of the payload (generated by the service)
          serviceNodeKey:
            type: string
            description: ID of the client
          data:
            type: object
            description: Data
          command:
            type: string
            description: Command name
          success:
            type: boolean
            description: Indicate if there is an error in the payload processing
          error:
            type: string
            description: Detailed description of the error(s)
    command:
      payload:
        type: object
        properties:
          name:
            type: string
            description: Command name/ID
          args:
            type: array
            description: Array of arguments
          messageId:
            type: string
            description: Message Id
          chatId:
            type: string
            description: Chat Id